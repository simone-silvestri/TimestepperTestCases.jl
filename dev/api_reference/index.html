<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · TimestepperTestCases.jl</title><meta name="title" content="API Reference · TimestepperTestCases.jl"/><meta property="og:title" content="API Reference · TimestepperTestCases.jl"/><meta property="twitter:title" content="API Reference · TimestepperTestCases.jl"/><meta name="description" content="Documentation for TimestepperTestCases.jl."/><meta property="og:description" content="Documentation for TimestepperTestCases.jl."/><meta property="twitter:description" content="Documentation for TimestepperTestCases.jl."/><meta property="og:url" content="https://simone-silvestri.github.io/TimestepperTestCases.jl/api_reference/"/><meta property="twitter:url" content="https://simone-silvestri.github.io/TimestepperTestCases.jl/api_reference/"/><link rel="canonical" href="https://simone-silvestri.github.io/TimestepperTestCases.jl/api_reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TimestepperTestCases.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><span class="tocitem">Experiments</span><ul><li><a class="tocitem" href="../experiments/internal_tide/">Internal Tide</a></li><li><a class="tocitem" href="../experiments/idealized_coast/">Idealized Coast</a></li><li><a class="tocitem" href="../experiments/channel/">Channel Flow</a></li></ul></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../stability/">Stability Analysis</a></li><li><a class="tocitem" href="../notebooks/">Notebooks</a></li><li class="is-active"><a class="tocitem" href>API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/simone-silvestri/TimestepperTestCases.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/main/docs/src/api_reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><p>Complete API documentation for TimestepperTestCases.jl.</p><article><details class="docstring" open="true"><summary id="TimestepperTestCases.Diffusivity-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.Diffusivity-Tuple{Any, Any, Any}"><code>TimestepperTestCases.Diffusivity</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Diffusivity(case, t, var)</code></pre><p>Compute the effective numerical diffusivity from variance dissipation diagnostics.</p><pre><code class="language-julia hljs">Diffusivity(case, t, var)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>case</code>: Case dictionary containing dissipation and gradient fields</li><li><code>t</code>: Time index</li><li><code>var</code>: Variable symbol (e.g., <code>:b</code> for buoyancy)</li></ul><p><strong>Returns</strong></p><ul><li><code>KernelFunctionOperation</code> representing the numerical diffusivity field</li></ul><p>The diffusivity is computed as <code>κ = -0.5 * (Ax + Az) / Gz</code>, where <code>Ax</code> and <code>Az</code> are the advective dissipation rates and <code>Gz</code> is the vertical gradient squared. This provides a local measure of numerical mixing, as described in the paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/load_internal_tide_case.jl#L107-L125">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.KineticEnergy-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.KineticEnergy-Tuple{Any, Any}"><code>TimestepperTestCases.KineticEnergy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">KineticEnergy(case, i)</code></pre><p>Compute the volume-averaged kinetic energy at time index <code>i</code>.</p><pre><code class="language-julia hljs">KineticEnergy(case, i)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>case</code>: Case dictionary containing velocity and volume fields</li><li><code>i</code>: Time index</li></ul><p><strong>Returns</strong></p><ul><li>Volume-averaged kinetic energy [m²/s²]: <code>(u² + v² + w²) / V</code></li></ul><p>Kinetic energy is computed using volume-weighted velocity components at their respective grid locations (u at Face-Center-Center, v at Center-Face-Center, w at Center-Center-Face).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/load_channel_case.jl#L89-L105">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.MeanKineticEnergy-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.MeanKineticEnergy-Tuple{Any, Any}"><code>TimestepperTestCases.MeanKineticEnergy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">MeanKineticEnergy(case, i)</code></pre><p>Compute the volume-averaged mean kinetic energy (zonally averaged) at time index <code>i</code>.</p><pre><code class="language-julia hljs">MeanKineticEnergy(case, i)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>case</code>: Case dictionary containing velocity and volume fields</li><li><code>i</code>: Time index</li></ul><p><strong>Returns</strong></p><ul><li>Volume-averaged mean kinetic energy [m²/s²]</li></ul><p>Mean kinetic energy is computed from zonally averaged velocity components, representing the energy in the mean flow rather than eddy kinetic energy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/load_channel_case.jl#L123-L139">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.buoyancy_flux-NTuple{6, Any}"><a class="docstring-binding" href="#TimestepperTestCases.buoyancy_flux-NTuple{6, Any}"><code>TimestepperTestCases.buoyancy_flux</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">buoyancy_flux(i, j, grid, clock, model_fields, p)</code></pre><p>Compute the surface buoyancy flux forcing.</p><pre><code class="language-julia hljs">buoyancy_flux(i, j, grid, clock, model_fields, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>i, j</code>: Grid indices</li><li><code>grid</code>: Grid object</li><li><code>clock</code>: Simulation clock</li><li><code>model_fields</code>: Model fields</li><li><code>p</code>: Parameters named tuple containing <code>Qᵇ</code> (flux magnitude), <code>y_shutoff</code> (shutoff location), and <code>Ly</code> (domain length)</li></ul><p><strong>Returns</strong></p><ul><li>Surface buoyancy flux [m²/s³] following a cosine profile, zero beyond <code>y_shutoff</code></li></ul><p>The flux profile is <code>Qᵇ * cos(3π * y / Ly)</code> for <code>y &lt; y_shutoff</code>, providing differential heating/cooling that drives meridional circulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L76-L95">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.buoyancy_relaxation-NTuple{7, Any}"><a class="docstring-binding" href="#TimestepperTestCases.buoyancy_relaxation-NTuple{7, Any}"><code>TimestepperTestCases.buoyancy_relaxation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">buoyancy_relaxation(i, j, k, grid, clock, model_fields, p)</code></pre><p>Compute the buoyancy relaxation forcing in the sponge layer.</p><pre><code class="language-julia hljs">buoyancy_relaxation(i, j, k, grid, clock, model_fields, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>i, j, k</code>: Grid indices</li><li><code>grid</code>: Grid object</li><li><code>clock</code>: Simulation clock</li><li><code>model_fields</code>: Model fields</li><li><code>p</code>: Parameters named tuple containing relaxation parameters</li></ul><p><strong>Returns</strong></p><ul><li>Buoyancy relaxation rate [m/s³] that restores buoyancy toward the initial profile in the sponge layer</li></ul><p>This forcing relaxes buoyancy toward the initial exponential profile in the northern sponge region, with strength controlled by <code>mask(y, p) / λt</code> where <code>λt</code> is the relaxation timescale.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L45-L64">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.calculate_z★_diagnostics-Tuple{Oceananigans.Fields.Field, Any}"><a class="docstring-binding" href="#TimestepperTestCases.calculate_z★_diagnostics-Tuple{Oceananigans.Fields.Field, Any}"><code>TimestepperTestCases.calculate_z★_diagnostics</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calculate_z★_diagnostics(b::Field, vol)</code></pre><p>Calculate the re-sorted height field <code>z★</code> from buoyancy and volume fields.</p><pre><code class="language-julia hljs">calculate_z★_diagnostics(b, vol)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>b</code>: Buoyancy field</li><li><code>vol</code>: Volume field</li></ul><p><strong>Returns</strong></p><ul><li><code>z★</code> field representing the height each fluid parcel would occupy after adiabatic re-sorting</li></ul><p>The re-sorted height is computed by sorting the buoyancy field and computing cumulative volume distribution, providing a reference state for potential energy calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/diagnostics.jl#L125-L141">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.compute_rpe_density-Tuple{Dict}"><a class="docstring-binding" href="#TimestepperTestCases.compute_rpe_density-Tuple{Dict}"><code>TimestepperTestCases.compute_rpe_density</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_rpe_density(case::Dict)</code></pre><p>Compute reference potential energy (RPE) and available potential energy (APE) time series from a case dictionary.</p><pre><code class="language-julia hljs">compute_rpe_density(case)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>case</code>: Dictionary containing <code>:b</code> (buoyancy FieldTimeSeries) and <code>:VCCC</code> (volume FieldTimeSeries)</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with <code>rpe</code> and <code>ape</code> arrays containing volume-averaged RPE and APE at each time step</li></ul><p>RPE represents the minimum potential energy achievable by adiabatic re-sorting of the density field, while APE is the difference between actual and reference potential energy. These diagnostics are used to quantify irreversible mixing, as described in the paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/diagnostics.jl#L29-L45">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.compute_rpe_density-Tuple{Oceananigans.Fields.Field, Any}"><a class="docstring-binding" href="#TimestepperTestCases.compute_rpe_density-Tuple{Oceananigans.Fields.Field, Any}"><code>TimestepperTestCases.compute_rpe_density</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_rpe_density(b::Field, vol)</code></pre><p>Compute RPE and APE density fields from buoyancy and volume fields.</p><pre><code class="language-julia hljs">compute_rpe_density(b, vol)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>b</code>: Buoyancy field</li><li><code>vol</code>: Volume field</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with <code>ze</code> (re-sorted height), <code>εe</code> (RPE density), and <code>αe</code> (APE density) fields</li></ul><p>This function computes the re-sorted height <code>z★</code> by sorting buoyancy and computing the cumulative volume distribution. RPE density is <code>ρ * z★</code> and APE density is <code>ρ * (z - z★)</code>, where <code>ρ</code> is computed from buoyancy using the linear equation of state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/diagnostics.jl#L92-L109">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.compute_rpe_density_two-Tuple{Dict}"><a class="docstring-binding" href="#TimestepperTestCases.compute_rpe_density_two-Tuple{Dict}"><code>TimestepperTestCases.compute_rpe_density_two</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_rpe_density_two(case::Dict)</code></pre><p>Compute RPE and APE time series using buoyancy directly (without volume weighting).</p><pre><code class="language-julia hljs">compute_rpe_density_two(case)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>case</code>: Dictionary containing <code>:b</code> (buoyancy FieldTimeSeries) and <code>:VCCC</code> (volume FieldTimeSeries)</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with <code>rpe</code> and <code>ape</code> arrays</li></ul><p>This variant computes RPE/APE using the buoyancy field directly, suitable for cases where buoyancy is already volume-weighted or when using different volume conventions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/diagnostics.jl#L60-L75">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.compute_tracer_dissipation!-Tuple{Any}"><a class="docstring-binding" href="#TimestepperTestCases.compute_tracer_dissipation!-Tuple{Any}"><code>TimestepperTestCases.compute_tracer_dissipation!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_tracer_dissipation!(sim)</code></pre><p>Compute the time rate of change of tracer variance (dissipation) for tracers <code>b</code> and <code>c</code>.</p><pre><code class="language-julia hljs">compute_tracer_dissipation!(sim)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>sim</code>: The <code>Simulation</code> object containing the model with tracers <code>b</code> and <code>c</code></li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code> (modifies <code>sim.model.auxiliary_fields</code> in place)</li></ul><p>This function computes the dissipation rate of tracer variance, defined as <code>Δtc² = (c² - c⁻²) / Δt</code> where <code>c⁻</code> is the tracer value from the previous time step. The results are stored in <code>sim.model.auxiliary_fields.Δtc²</code> and <code>sim.model.auxiliary_fields.Δtb²</code>.</p><p>This diagnostic is used to quantify numerical mixing introduced by the time discretization, as described in the paper&#39;s appendix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/internal_tide.jl#L97-L116">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.default_closure-Tuple{}"><a class="docstring-binding" href="#TimestepperTestCases.default_closure-Tuple{}"><code>TimestepperTestCases.default_closure</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">default_closure()</code></pre><p>Return the default turbulence closure for the channel simulation.</p><pre><code class="language-julia hljs">default_closure()
</code></pre><p><strong>Returns</strong></p><ul><li><code>CATKEVerticalDiffusivity</code> closure with default parameters</li></ul><p>This closure uses the CATKE (Convective Adjustment and TKE) parameterization for vertical mixing, which is appropriate for equilibrated channel flows with mesoscale forcing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L222-L234">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.default_grid-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.default_grid-Tuple{Any, Any, Any}"><code>TimestepperTestCases.default_grid</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">default_grid(arch, zstar, bottom_height)</code></pre><p>Construct the default grid for the channel simulation.</p><pre><code class="language-julia hljs">default_grid(arch, zstar, bottom_height)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>arch</code>: Architecture to use (<code>CPU()</code> or <code>GPU()</code>)</li><li><code>zstar</code>: Whether to use z-star vertical coordinates</li><li><code>bottom_height</code>: Optional bottom height function <code>(x, y) -&gt; z</code>, or <code>nothing</code> for flat bottom</li></ul><p><strong>Returns</strong></p><ul><li><code>RectilinearGrid</code> or <code>ImmersedBoundaryGrid</code> with 200×400×90 grid points</li></ul><p>The grid spans 1000 km zonally (periodic), 2000 km meridionally (bounded), and uses 90 non-uniform vertical layers with finer spacing near the surface and bottom.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L131-L148">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.hasclosure-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.hasclosure-Tuple{Any, Any}"><code>TimestepperTestCases.hasclosure</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hasclosure(closure, ClosureType)</code></pre><p>Check if a closure or tuple of closures contains a specific closure type.</p><pre><code class="language-julia hljs">hasclosure(closure, ClosureType)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>closure</code>: A single closure or tuple of closures</li><li><code>ClosureType</code>: The closure type to check for</li></ul><p><strong>Returns</strong></p><ul><li><code>true</code> if <code>closure</code> is of type <code>ClosureType</code> or contains it in a tuple, <code>false</code> otherwise</li></ul><p>This helper function is used to determine if CATKE or other specific closures are present in the closure configuration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L183-L199">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.idealized_coast-Tuple{Symbol}"><a class="docstring-binding" href="#TimestepperTestCases.idealized_coast-Tuple{Symbol}"><code>TimestepperTestCases.idealized_coast</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">idealized_coast(timestepper::Symbol; arch, forced, lowres, free_surface)</code></pre><p>Set up and run the idealized coastal baroclinic adjustment test case simulation.</p><pre><code class="language-julia hljs">idealized_coast(
    timestepper;
    arch,
    forced,
    lowres,
    free_surface
)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>timestepper</code>: Symbol indicating the timestepper (<code>:QuasiAdamsBashforth2</code> or <code>:SplitRungeKutta3</code>)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>arch</code>: Architecture to run on (default: <code>CPU()</code>)</li><li><code>forced</code>: Whether to apply wind forcing (default: <code>true</code>)</li><li><code>lowres</code>: Whether to use low resolution (default: <code>false</code>)</li><li><code>free_surface</code>: Free surface formulation (default: <code>SplitExplicitFreeSurface</code> with CFL=0.7)</li></ul><p><strong>Returns</strong></p><ul><li><code>Simulation</code> object configured but not yet run</li></ul><p>This function sets up the idealized coastal baroclinic adjustment test case described in the paper. The configuration features a rectangular domain with a linearly sloping bathymetry and initial meridional salinity gradient that drives baroclinic instabilities. The test case demonstrates how numerical mixing can suppress submesoscale variability, as shown in the paper.</p><p>The simulation runs for 40 days and outputs velocity, temperature, salinity, buoyancy, and variance dissipation diagnostics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/idealized_coast.jl#L65-L91">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.idealized_coast_timestep-Tuple{Val{:QuasiAdamsBashforth2}}"><a class="docstring-binding" href="#TimestepperTestCases.idealized_coast_timestep-Tuple{Val{:QuasiAdamsBashforth2}}"><code>TimestepperTestCases.idealized_coast_timestep</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">idealized_coast_timestep(::Val{timestepper})</code></pre><p>Return the recommended time step for the idealized coast test case given a timestepper.</p><pre><code class="language-julia hljs">idealized_coast_timestep(_)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>timestepper</code>: Symbol indicating the timestepper (<code>:QuasiAdamsBashforth2</code> or <code>:SplitRungeKutta3</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Recommended time step [s] for the given timestepper</li></ul><p>Time steps are chosen to match computational cost between AB2 and RK schemes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/idealized_coast.jl#L37-L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.initial_buoyancy-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.initial_buoyancy-Tuple{Any, Any}"><code>TimestepperTestCases.initial_buoyancy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_buoyancy(z, p)</code></pre><p>Compute the initial buoyancy profile as a function of depth.</p><pre><code class="language-julia hljs">initial_buoyancy(z, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>z</code>: Vertical position [m]</li><li><code>p</code>: Parameters named tuple containing <code>ΔB</code> (surface buoyancy gradient), <code>h</code> (decay scale), and <code>Lz</code> (domain depth)</li></ul><p><strong>Returns</strong></p><ul><li>Initial buoyancy [m/s²] following an exponential profile</li></ul><p>The profile follows <code>ΔB * (exp(z/h) - exp(-Lz/h)) / (1 - exp(-Lz/h))</code>, which provides a stable stratification that decays exponentially with depth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L8-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.internal_tide-Tuple{Symbol}"><a class="docstring-binding" href="#TimestepperTestCases.internal_tide-Tuple{Symbol}"><code>TimestepperTestCases.internal_tide</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">internal_tide(timestepper::Symbol; free_surface, tracer_advection)</code></pre><p>Set up and run the internal tide test case simulation.</p><pre><code class="language-julia hljs">internal_tide(timestepper; free_surface, tracer_advection)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>timestepper</code>: Symbol indicating the timestepper (<code>:QuasiAdamsBashforth2</code>, <code>:SplitRungeKutta3</code>, or <code>:SplitRungeKutta4</code>)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>free_surface</code>: Free surface formulation (default: <code>SplitExplicitFreeSurface</code> with 60 substeps)</li><li><code>tracer_advection</code>: Tracer advection scheme (default: 7th-order WENO)</li></ul><p><strong>Returns</strong></p><ul><li><code>Simulation</code> object after running to completion</li></ul><p>This function sets up the internal tide test case described in the paper, which simulates tidal flow over a Gaussian seamount. The domain is initially stratified and forced by an oscillatory tidal forcing. The simulation runs for 40 days and outputs velocity, buoyancy, tracer fields, and dissipation diagnostics.</p><p>The test case isolates the role of time discretization in numerical mixing, as spatial advection plays a secondary role in this mostly linear configuration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/internal_tide.jl#L181-L205">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.internal_tide_grid-Tuple{}"><a class="docstring-binding" href="#TimestepperTestCases.internal_tide_grid-Tuple{}"><code>TimestepperTestCases.internal_tide_grid</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">internal_tide_grid()</code></pre><p>Construct the grid for the internal tide test case with a Gaussian seamount.</p><pre><code class="language-julia hljs">internal_tide_grid()
</code></pre><p><strong>Returns</strong></p><ul><li><code>ImmersedBoundaryGrid</code> with periodic horizontal boundaries and a Gaussian seamount bottom</li></ul><p>The grid spans from <code>-L</code> to <code>L</code> horizontally (periodic) and from <code>-H</code> to <code>0</code> vertically (bounded). A Gaussian seamount of height <code>h₀</code> and width <code>width</code> is imposed using an immersed boundary method. The grid parameters are taken from <code>internal_tide_parameters()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/internal_tide.jl#L135-L148">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.internal_tide_parameters-Tuple{}"><a class="docstring-binding" href="#TimestepperTestCases.internal_tide_parameters-Tuple{}"><code>TimestepperTestCases.internal_tide_parameters</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">internal_tide_parameters()</code></pre><p>Return a named tuple containing the default parameters for the internal tide test case.</p><pre><code class="language-julia hljs">internal_tide_parameters()
</code></pre><p><strong>Returns</strong></p><ul><li><code>Nx</code>: Number of grid points in the horizontal (x) direction</li><li><code>Nz</code>: Number of grid points in the vertical (z) direction</li><li><code>H</code>: Domain depth [m]</li><li><code>L</code>: Domain half-length [m]</li><li><code>h₀</code>: Seamount height [m]</li><li><code>width</code>: Seamount width [m]</li><li><code>T₂</code>: Tidal period [s]</li><li><code>ω₂</code>: Tidal frequency [rad/s]</li><li><code>ϵ</code>: Excursion parameter (dimensionless)</li><li><code>U₂</code>: Characteristic tidal velocity [m/s]</li><li><code>f</code>: Coriolis parameter [s⁻¹]</li><li><code>A₂</code>: Tidal forcing amplitude [m/s²]</li><li><code>Nᵢ²</code>: Initial stratification [s⁻²]</li></ul><p>These parameters define a 2-kilometer deep domain with a Gaussian seamount that interacts with an oscillatory tidal forcing, as described in the paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/internal_tide.jl#L5-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.internal_tide_timestep-Tuple{Val{:QuasiAdamsBashforth2}}"><a class="docstring-binding" href="#TimestepperTestCases.internal_tide_timestep-Tuple{Val{:QuasiAdamsBashforth2}}"><code>TimestepperTestCases.internal_tide_timestep</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">internal_tide_timestep(::Val{timestepper})</code></pre><p>Return the recommended time step for the internal tide test case given a timestepper.</p><pre><code class="language-julia hljs">internal_tide_timestep(_)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>timestepper</code>: Symbol indicating the timestepper (<code>:QuasiAdamsBashforth2</code>, <code>:SplitRungeKutta3</code>, or <code>:SplitRungeKutta4</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Recommended time step [s] for the given timestepper</li></ul><p>The time steps are chosen to match computational cost between AB2 and RK schemes while maintaining stability, as described in the paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/internal_tide.jl#L69-L84">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.load_channel-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.load_channel-Tuple{Any, Any}"><code>TimestepperTestCases.load_channel</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">load_channel(folder, case_number; arch)</code></pre><p>Load and process channel simulation output data.</p><pre><code class="language-julia hljs">load_channel(folder, case_number; arch)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>folder</code>: Directory containing the simulation output files</li><li><code>case_number</code>: Case identifier string</li><li><code>arch</code>: Architecture to load data on (default: <code>CPU()</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Dictionary containing velocity, buoyancy, volume, and energy diagnostics</li></ul><p>This function loads channel simulation snapshots and computes kinetic energy, mean kinetic energy, and potential energy diagnostics for equilibrated channel flow analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/load_channel_case.jl#L11-L28">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.load_idealized_coast-NTuple{4, Any}"><a class="docstring-binding" href="#TimestepperTestCases.load_idealized_coast-NTuple{4, Any}"><code>TimestepperTestCases.load_idealized_coast</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">load_idealized_coast(folder, closure, suffix, timestepper)</code></pre><p>Load and process idealized coast simulation output data.</p><pre><code class="language-julia hljs">load_idealized_coast(folder, closure, suffix, timestepper)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>folder</code>: Directory containing the simulation output files</li><li><code>closure</code>: Closure name string (e.g., <code>&quot;CATKE&quot;</code>)</li><li><code>suffix</code>: Filename suffix string (e.g., <code>&quot;split_free_surface_&quot;</code>)</li><li><code>timestepper</code>: Timestepper name string (e.g., <code>&quot;SplitRungeKutta3&quot;</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Dictionary containing velocity, tracer, dissipation, and energy diagnostics</li></ul><p>Similar to <code>load_internal_tide</code>, but includes additional fields for temperature and salinity dissipation diagnostics, as well as three-dimensional volume fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/load_idealized_coast_case.jl#L67-L85">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.load_internal_tide-Tuple{Any, Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.load_internal_tide-Tuple{Any, Any, Any}"><code>TimestepperTestCases.load_internal_tide</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">load_internal_tide(folder, timestepper, free_surface)</code></pre><p>Load and process internal tide simulation output data.</p><pre><code class="language-julia hljs">load_internal_tide(folder, timestepper, free_surface)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>folder</code>: Directory containing the simulation output files</li><li><code>timestepper</code>: Timestepper name string (e.g., <code>&quot;SplitRungeKutta3&quot;</code>)</li><li><code>free_surface</code>: Free surface type string (e.g., <code>&quot;split_free_surface_DFB&quot;</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Dictionary containing:<ul><li><code>:u</code>, <code>:w</code>, <code>:b</code>, <code>:η</code>: Velocity, buoyancy, and free surface FieldTimeSeries</li><li><code>:VCCC</code>, <code>:VFCC</code>, <code>:VCCF</code>: Volume FieldTimeSeries at different grid locations</li><li><code>:Abx</code>, <code>:Abz</code>: Advective buoyancy dissipation in x and z directions</li><li><code>:Gbx</code>, <code>:Gbz</code>: Buoyancy gradient squared in x and z directions</li><li><code>:abx</code>, <code>:abz</code>, <code>:abt</code>: Volume-averaged dissipation rates</li><li><code>:gbx</code>, <code>:gbz</code>, <code>:gbt</code>: Volume-averaged gradient squared</li><li><code>:κb</code>: Effective numerical diffusivity</li><li><code>:KE</code>, <code>:MKE</code>: Kinetic energy and mean kinetic energy time series</li><li><code>:η2</code>: Free surface variance time series</li><li><code>:RPE</code>, <code>:APE</code>: Reference and available potential energy time series</li></ul></li></ul><p>This function loads simulation output, computes volume fields accounting for free surface variations, and calculates various diagnostics used for analyzing numerical mixing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/load_internal_tide_case.jl#L1-L28">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.mask-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.mask-Tuple{Any, Any}"><code>TimestepperTestCases.mask</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">mask(y, p)</code></pre><p>Compute the sponge layer mask function for buoyancy relaxation.</p><pre><code class="language-julia hljs">mask(y, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>y</code>: Meridional position [m]</li><li><code>p</code>: Parameters named tuple containing <code>Ly</code> (domain length) and <code>Lsponge</code> (sponge layer width)</li></ul><p><strong>Returns</strong></p><ul><li>Mask value between 0 and 1, increasing linearly from 0 at <code>y = Ly - Lsponge</code> to 1 at <code>y = Ly</code></li></ul><p>This function creates a sponge layer mask used for buoyancy restoring at the northern boundary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L27-L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.print_progress-Tuple{Any}"><a class="docstring-binding" href="#TimestepperTestCases.print_progress-Tuple{Any}"><code>TimestepperTestCases.print_progress</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">print_progress(sim)</code></pre><p>Print simulation progress information including completion percentage, iteration number, simulation time, wall clock time, maximum velocity components, and next time step.</p><pre><code class="language-julia hljs">print_progress(sim)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>sim</code>: The <code>Simulation</code> object to print progress for.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code></li></ul><p>This callback function is typically added to simulations using <code>add_callback!</code> to monitor progress during long-running simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/TimestepperTestCases.jl#L15-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.run_channel_simulation-Tuple{}"><a class="docstring-binding" href="#TimestepperTestCases.run_channel_simulation-Tuple{}"><code>TimestepperTestCases.run_channel_simulation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">run_channel_simulation(; momentum_advection, tracer_advection, closure, zstar, restart_file, arch, bottom_height, timestepper, grid, initial_file, testcase)</code></pre><p>Set up and run the idealized re-entrant channel flow simulation.</p><pre><code class="language-julia hljs">run_channel_simulation(
;
    momentum_advection,
    tracer_advection,
    closure,
    zstar,
    restart_file,
    arch,
    bottom_height,
    timestepper,
    grid,
    initial_file,
    testcase
)
</code></pre><p><strong>Keyword Arguments</strong></p><ul><li><code>momentum_advection</code>: Momentum advection scheme (default: <code>WENOVectorInvariant()</code>)</li><li><code>tracer_advection</code>: Tracer advection scheme (default: 7th-order WENO)</li><li><code>closure</code>: Turbulence closure (default: <code>CATKEVerticalDiffusivity</code>)</li><li><code>zstar</code>: Whether to use z-star vertical coordinates (default: <code>true</code>)</li><li><code>restart_file</code>: Optional restart file path (default: <code>nothing</code>)</li><li><code>arch</code>: Architecture to run on (default: <code>CPU()</code>)</li><li><code>bottom_height</code>: Optional bottom height function (default: <code>nothing</code> for flat bottom)</li><li><code>timestepper</code>: Timestepper symbol (default: <code>:SplitRungeKutta</code>)</li><li><code>grid</code>: Grid to use (default: <code>default_grid(...)</code>)</li><li><code>initial_file</code>: Optional initial condition file (default: <code>&quot;tIni_80y_90L.bin&quot;</code>)</li><li><code>testcase</code>: Test case identifier string (default: <code>&quot;0&quot;</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Simulation</code> object after running to completion</li></ul><p>This function sets up the idealized re-entrant channel test case described in the paper. The configuration consists of a 1000 km × 2000 km × 3 km periodic channel forced by sinusoidal wind stress and variable surface heat flux. Buoyancy is restored at the northern boundary to maintain an equilibrated state.</p><p>The simulation includes a spin-up phase followed by a long integration (40 years) with time-averaged outputs. This test case demonstrates how numerical mixing interacts with explicit physical mixing in an equilibrated configuration, as shown in the paper.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L241-L272">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.simulation_Δt-Tuple{Val{:QuasiAdamsBashforth2}}"><a class="docstring-binding" href="#TimestepperTestCases.simulation_Δt-Tuple{Val{:QuasiAdamsBashforth2}}"><code>TimestepperTestCases.simulation_Δt</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">simulation_Δt(::Val{timestepper})</code></pre><p>Return the recommended time step for the channel simulation given a timestepper.</p><pre><code class="language-julia hljs">simulation_Δt(_)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>timestepper</code>: Symbol indicating the timestepper (<code>:QuasiAdamsBashforth2</code>, <code>:SplitRungeKutta3</code>, or <code>:SplitRungeKutta6</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Recommended time step [s] for the given timestepper</li></ul><p>Time steps are chosen to match computational cost between different timesteppers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L203-L217">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.tidal_forcing-NTuple{4, Any}"><a class="docstring-binding" href="#TimestepperTestCases.tidal_forcing-NTuple{4, Any}"><code>TimestepperTestCases.tidal_forcing</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">tidal_forcing(x, z, t, p)</code></pre><p>Compute the tidal forcing amplitude at position <code>(x, z)</code> and time <code>t</code>.</p><pre><code class="language-julia hljs">tidal_forcing(x, z, t, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>x</code>: Horizontal position [m]</li><li><code>z</code>: Vertical position [m]</li><li><code>t</code>: Time [s]</li><li><code>p</code>: Parameters named tuple containing <code>A₂</code> (forcing amplitude) and <code>ω₂</code> (tidal frequency)</li></ul><p><strong>Returns</strong></p><ul><li>Forcing amplitude [m/s²] as a function of time only: <code>A₂ * sin(ω₂ * t)</code></li></ul><p>This function implements a simple oscillatory tidal forcing that varies sinusoidally in time with amplitude <code>A₂</code> and frequency <code>ω₂</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/internal_tide.jl#L48-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.u_stress-NTuple{6, Any}"><a class="docstring-binding" href="#TimestepperTestCases.u_stress-NTuple{6, Any}"><code>TimestepperTestCases.u_stress</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">u_stress(i, j, grid, clock, model_fields, p)</code></pre><p>Compute the zonal wind stress at the surface.</p><pre><code class="language-julia hljs">u_stress(i, j, grid, clock, model_fields, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>i, j</code>: Grid indices</li><li><code>grid</code>: Grid object</li><li><code>clock</code>: Simulation clock</li><li><code>model_fields</code>: Model fields</li><li><code>p</code>: Parameters named tuple containing <code>τ</code> (stress magnitude) and <code>Ly</code> (domain length)</li></ul><p><strong>Returns</strong></p><ul><li>Zonal wind stress [m²/s²] following a sine profile: <code>-τ * sin(π * y / Ly)</code></li></ul><p>This implements a sinusoidal wind stress profile that drives zonal flow, with maximum stress at the domain center and zero at the boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/channel_simulation.jl#L102-L121">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.wind_stress-NTuple{6, Any}"><a class="docstring-binding" href="#TimestepperTestCases.wind_stress-NTuple{6, Any}"><code>TimestepperTestCases.wind_stress</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">wind_stress(i, j, grid, clock, fields, p)</code></pre><p>Compute the wind stress forcing at grid point <code>(i, j)</code>.</p><pre><code class="language-julia hljs">wind_stress(i, j, grid, clock, fields, p)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>i, j</code>: Grid indices</li><li><code>grid</code>: Grid object</li><li><code>clock</code>: Simulation clock</li><li><code>fields</code>: Model fields</li><li><code>p</code>: Parameters named tuple containing <code>τ₀</code> (stress amplitude) and <code>f</code> (frequency)</li></ul><p><strong>Returns</strong></p><ul><li>Wind stress [m²/s²] that activates after 4 days: <code>τ₀ * sin(f * t)</code> if <code>t &gt; 4 days</code>, else <code>0</code></li></ul><p>This function implements a time-dependent wind stress that begins after a 4-day spin-up period and oscillates with frequency <code>f</code> and amplitude <code>τ₀</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/idealized_coast.jl#L11-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation-Tuple{Any}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation-Tuple{Any}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">(ϵ::BuoyancyVarianceDissipation)(model)</code></pre><p>Compute buoyancy variance dissipation and update flux caches for the next time step.</p><pre><code class="language-julia hljs">BuoyancyVarianceDissipation(grid; Uⁿ⁻¹, Uⁿ)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>model</code>: The <code>HydrostaticFreeSurfaceModel</code> containing temperature and salinity tracers</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code> (modifies <code>ϵ</code> in place)</li></ul><p>This function is called as a simulation callback to compute the advective dissipation of buoyancy variance at each time step. It first computes dissipation from previously cached fluxes, then updates the flux caches for the next time step.</p><p>The model must have <code>:T</code> and <code>:S</code> tracers to compute buoyancy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/BuoyancyVarianceDissipationComputations.jl#L111-L129">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.c_grid_vector-Tuple{Any}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.c_grid_vector-Tuple{Any}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.c_grid_vector</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">c_grid_vector(grid)</code></pre><p>Create a named tuple of C-grid vector fields (x, y, z components at face locations).</p><pre><code class="language-julia hljs">c_grid_vector(grid)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>grid</code>: Grid on which to create the fields</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with <code>x</code>, <code>y</code>, <code>z</code> fields at XFace, YFace, and ZFace locations respectively</li></ul><p>This helper function creates the vector fields needed to store advective fluxes and dissipation rates at their proper staggered grid locations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/BuoyancyVarianceDissipationComputations.jl#L44-L59">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.cache_fluxes!-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.cache_fluxes!-Tuple{Any, Any}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.cache_fluxes!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">cache_fluxes!(dissipation, model)</code></pre><p>Cache advective fluxes and update velocity fields for dissipation computation.</p><pre><code class="language-julia hljs">cache_fluxes!(dissipation, model)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>dissipation</code>: <code>BuoyancyVarianceDissipation</code> object</li><li><code>model</code>: The model containing velocities and tracers</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code> (modifies <code>dissipation</code> in place)</li></ul><p>This function updates the velocity fields (<code>Uⁿ</code>, <code>Uⁿ⁻¹</code>) and caches the advective buoyancy fluxes (<code>Fⁿ</code>, <code>Fⁿ⁻¹</code>) needed for computing dissipation at the next time step. The caching procedure depends on the timestepper type and stage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/update_fluxes.jl#L7-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.compute_dissipation!-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.compute_dissipation!-Tuple{Any, Any}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.compute_dissipation!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_dissipation!(dissipation, model)</code></pre><p>Compute the numerical dissipation of buoyancy variance from previously calculated advective fluxes.</p><pre><code class="language-julia hljs">compute_dissipation!(dissipation, model)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>dissipation</code>: <code>BuoyancyVarianceDissipation</code> object containing cached fluxes</li><li><code>model</code>: The model containing tracers and timestepper information</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code> (modifies <code>dissipation.advective_production</code> in place)</li></ul><p>The dissipation is computed using the formulation:</p><pre><code class="language-julia hljs">A = 2 * δc★ * F - U δc²  # For advective dissipation</code></pre><p>where <code>F</code> is the flux associated with advection, <code>U</code> is the advecting velocity, <code>c★</code> and <code>c²</code> are functions of the buoyancy field.</p><p>For multi-stage timesteppers, the fluxes and velocities must account for the substepping procedure. For AB2: <code>F = 1.5 Fⁿ - 0.5 Fⁿ⁻¹</code> and <code>U = 1.5 Uⁿ - 0.5 Uⁿ⁻¹</code>. For RK schemes, the fluxes from the appropriate substep are used.</p><p>This method is adapted from the exact variance budget methodology described in the paper&#39;s appendix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/compute_dissipation.jl#L4-L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.finally_cache_fluxes!-Tuple{Any, Any}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.finally_cache_fluxes!-Tuple{Any, Any}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.finally_cache_fluxes!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">finally_cache_fluxes!(dissipation, model)</code></pre><p>Cache advective buoyancy fluxes from temperature and salinity tracers.</p><pre><code class="language-julia hljs">finally_cache_fluxes!(dissipation, model)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>dissipation</code>: <code>BuoyancyVarianceDissipation</code> object</li><li><code>model</code>: The model containing tracers and advection scheme</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code> (modifies <code>dissipation.advective_fluxes</code> in place)</li></ul><p>This function computes the advective fluxes of buoyancy by combining temperature and salinity fluxes using the linear equation of state. The fluxes are computed at face locations and cached for use in dissipation computation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/update_fluxes.jl#L69-L86">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.flatten_dissipation_fields-Tuple{TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.flatten_dissipation_fields-Tuple{TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.flatten_dissipation_fields</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flatten_dissipation_fields(t::BuoyancyVarianceDissipation)</code></pre><p>Flatten the dissipation fields into a named tuple for output.</p><pre><code class="language-julia hljs">flatten_dissipation_fields(t)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>t</code>: <code>BuoyancyVarianceDissipation</code> object</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple containing <code>Abx</code>, <code>Aby</code>, <code>Abz</code> fields representing advective buoyancy dissipation in the x, y, and z directions respectively</li></ul><p>This function extracts the dissipation fields from the internal C-grid vector structure into a flat named tuple suitable for use as simulation outputs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/flatten_dissipation_fields.jl#L1-L17">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimestepperTestCases.BuoyancyVarianceDissipationComputations.flux_parameters-Tuple{Any}"><a class="docstring-binding" href="#TimestepperTestCases.BuoyancyVarianceDissipationComputations.flux_parameters-Tuple{Any}"><code>TimestepperTestCases.BuoyancyVarianceDissipationComputations.flux_parameters</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_parameters(grid)</code></pre><p>Compute kernel parameters for flux computation based on grid topology.</p><pre><code class="language-julia hljs">flux_parameters(grid)
</code></pre><p><strong>Arguments</strong></p><ul><li><code>grid</code>: Grid object</li></ul><p><strong>Returns</strong></p><ul><li><code>KernelParameters</code> object with appropriate index ranges for flux computation</li></ul><p>This function determines the correct index ranges for computing fluxes at face locations, accounting for flat (1D/2D) dimensions in the grid topology.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/simone-silvestri/TimestepperTestCases.jl/blob/efb243d88b26452d720aba786ab542f591990439/src/BuoyancyVarianceDissipationComputations/update_fluxes.jl#L44-L59">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../notebooks/">« Notebooks</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 3 December 2025 18:18">Wednesday 3 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
