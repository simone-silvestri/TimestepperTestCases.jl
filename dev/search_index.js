var documenterSearchIndex = {"docs":
[{"location":"api_reference/#API-Reference","page":"API Reference","title":"API Reference","text":"Complete API documentation for TimestepperTestCases.jl.","category":"section"},{"location":"api_reference/#TimestepperTestCases.Diffusivity-Tuple{Any, Any, Any}","page":"API Reference","title":"TimestepperTestCases.Diffusivity","text":"Diffusivity(case, t, var)\n\nCompute the effective numerical diffusivity from variance dissipation diagnostics.\n\nDiffusivity(case, t, var)\n\n\nArguments\n\ncase: Case dictionary containing dissipation and gradient fields\nt: Time index\nvar: Variable symbol (e.g., :b for buoyancy)\n\nReturns\n\nKernelFunctionOperation representing the numerical diffusivity field\n\nThe diffusivity is computed as κ = -0.5 * (Ax + Az) / Gz, where Ax and Az are the advective dissipation rates and Gz is the vertical gradient squared. This provides a local measure of numerical mixing, as described in the paper.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.KineticEnergy-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.KineticEnergy","text":"KineticEnergy(case, i)\n\nCompute the volume-averaged kinetic energy at time index i.\n\nKineticEnergy(case, i)\n\n\nArguments\n\ncase: Case dictionary containing velocity and volume fields\ni: Time index\n\nReturns\n\nVolume-averaged kinetic energy [m²/s²]: (u² + v² + w²) / V\n\nKinetic energy is computed using volume-weighted velocity components at their respective grid locations (u at Face-Center-Center, v at Center-Face-Center, w at Center-Center-Face).\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.MeanKineticEnergy-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.MeanKineticEnergy","text":"MeanKineticEnergy(case, i)\n\nCompute the volume-averaged mean kinetic energy (zonally averaged) at time index i.\n\nMeanKineticEnergy(case, i)\n\n\nArguments\n\ncase: Case dictionary containing velocity and volume fields\ni: Time index\n\nReturns\n\nVolume-averaged mean kinetic energy [m²/s²]\n\nMean kinetic energy is computed from zonally averaged velocity components, representing the energy in the mean flow rather than eddy kinetic energy.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.buoyancy_flux-NTuple{6, Any}","page":"API Reference","title":"TimestepperTestCases.buoyancy_flux","text":"buoyancy_flux(i, j, grid, clock, model_fields, p)\n\nCompute the surface buoyancy flux forcing.\n\nbuoyancy_flux(i, j, grid, clock, model_fields, p)\n\n\nArguments\n\ni, j: Grid indices\ngrid: Grid object\nclock: Simulation clock\nmodel_fields: Model fields\np: Parameters named tuple containing Qᵇ (flux magnitude), y_shutoff (shutoff location), and Ly (domain length)\n\nReturns\n\nSurface buoyancy flux [m²/s³] following a cosine profile, zero beyond y_shutoff\n\nThe flux profile is Qᵇ * cos(3π * y / Ly) for y < y_shutoff, providing differential heating/cooling that drives meridional circulation.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.buoyancy_relaxation-NTuple{7, Any}","page":"API Reference","title":"TimestepperTestCases.buoyancy_relaxation","text":"buoyancy_relaxation(i, j, k, grid, clock, model_fields, p)\n\nCompute the buoyancy relaxation forcing in the sponge layer.\n\nbuoyancy_relaxation(i, j, k, grid, clock, model_fields, p)\n\n\nArguments\n\ni, j, k: Grid indices\ngrid: Grid object\nclock: Simulation clock\nmodel_fields: Model fields\np: Parameters named tuple containing relaxation parameters\n\nReturns\n\nBuoyancy relaxation rate [m/s³] that restores buoyancy toward the initial profile in the sponge layer\n\nThis forcing relaxes buoyancy toward the initial exponential profile in the northern sponge region, with strength controlled by mask(y, p) / λt where λt is the relaxation timescale.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.calculate_z★_diagnostics-Tuple{Oceananigans.Fields.Field, Any}","page":"API Reference","title":"TimestepperTestCases.calculate_z★_diagnostics","text":"calculate_z★_diagnostics(b::Field, vol)\n\nCalculate the re-sorted height field z★ from buoyancy and volume fields.\n\ncalculate_z★_diagnostics(b, vol)\n\n\nArguments\n\nb: Buoyancy field\nvol: Volume field\n\nReturns\n\nz★ field representing the height each fluid parcel would occupy after adiabatic re-sorting\n\nThe re-sorted height is computed by sorting the buoyancy field and computing cumulative volume distribution, providing a reference state for potential energy calculations.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.compute_rpe_density-Tuple{Dict}","page":"API Reference","title":"TimestepperTestCases.compute_rpe_density","text":"compute_rpe_density(case::Dict)\n\nCompute reference potential energy (RPE) and available potential energy (APE) time series from a case dictionary.\n\ncompute_rpe_density(case)\n\n\nArguments\n\ncase: Dictionary containing :b (buoyancy FieldTimeSeries) and :VCCC (volume FieldTimeSeries)\n\nReturns\n\nNamed tuple with rpe and ape arrays containing volume-averaged RPE and APE at each time step\n\nRPE represents the minimum potential energy achievable by adiabatic re-sorting of the density field, while APE is the difference between actual and reference potential energy. These diagnostics are used to quantify irreversible mixing, as described in the paper.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.compute_rpe_density-Tuple{Oceananigans.Fields.Field, Any}","page":"API Reference","title":"TimestepperTestCases.compute_rpe_density","text":"compute_rpe_density(b::Field, vol)\n\nCompute RPE and APE density fields from buoyancy and volume fields.\n\ncompute_rpe_density(b, vol)\n\n\nArguments\n\nb: Buoyancy field\nvol: Volume field\n\nReturns\n\nNamed tuple with ze (re-sorted height), εe (RPE density), and αe (APE density) fields\n\nThis function computes the re-sorted height z★ by sorting buoyancy and computing the cumulative volume distribution. RPE density is ρ * z★ and APE density is ρ * (z - z★), where ρ is computed from buoyancy using the linear equation of state.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.compute_rpe_density_two-Tuple{Dict}","page":"API Reference","title":"TimestepperTestCases.compute_rpe_density_two","text":"compute_rpe_density_two(case::Dict)\n\nCompute RPE and APE time series using buoyancy directly (without volume weighting).\n\ncompute_rpe_density_two(case)\n\n\nArguments\n\ncase: Dictionary containing :b (buoyancy FieldTimeSeries) and :VCCC (volume FieldTimeSeries)\n\nReturns\n\nNamed tuple with rpe and ape arrays\n\nThis variant computes RPE/APE using the buoyancy field directly, suitable for cases where buoyancy is already volume-weighted or when using different volume conventions.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.compute_tracer_dissipation!-Tuple{Any}","page":"API Reference","title":"TimestepperTestCases.compute_tracer_dissipation!","text":"compute_tracer_dissipation!(sim)\n\nCompute the time rate of change of tracer variance (dissipation) for tracers b and c.\n\ncompute_tracer_dissipation!(sim)\n\n\nArguments\n\nsim: The Simulation object containing the model with tracers b and c\n\nReturns\n\nnothing (modifies sim.model.auxiliary_fields in place)\n\nThis function computes the dissipation rate of tracer variance, defined as Δtc² = (c² - c⁻²) / Δt where c⁻ is the tracer value from the previous time step. The results are stored in sim.model.auxiliary_fields.Δtc² and sim.model.auxiliary_fields.Δtb².\n\nThis diagnostic is used to quantify numerical mixing introduced by the time discretization, as described in the paper's appendix.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.default_closure-Tuple{}","page":"API Reference","title":"TimestepperTestCases.default_closure","text":"default_closure()\n\nReturn the default turbulence closure for the channel simulation.\n\ndefault_closure()\n\n\nReturns\n\nCATKEVerticalDiffusivity closure with default parameters\n\nThis closure uses the CATKE (Convective Adjustment and TKE) parameterization for vertical mixing, which is appropriate for equilibrated channel flows with mesoscale forcing.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.default_grid-Tuple{Any, Any, Any}","page":"API Reference","title":"TimestepperTestCases.default_grid","text":"default_grid(arch, zstar, bottom_height)\n\nConstruct the default grid for the channel simulation.\n\ndefault_grid(arch, zstar, bottom_height)\n\n\nArguments\n\narch: Architecture to use (CPU() or GPU())\nzstar: Whether to use z-star vertical coordinates\nbottom_height: Optional bottom height function (x, y) -> z, or nothing for flat bottom\n\nReturns\n\nRectilinearGrid or ImmersedBoundaryGrid with 200×400×90 grid points\n\nThe grid spans 1000 km zonally (periodic), 2000 km meridionally (bounded), and uses 90 non-uniform vertical layers with finer spacing near the surface and bottom.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.hasclosure-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.hasclosure","text":"hasclosure(closure, ClosureType)\n\nCheck if a closure or tuple of closures contains a specific closure type.\n\nhasclosure(closure, ClosureType)\n\n\nArguments\n\nclosure: A single closure or tuple of closures\nClosureType: The closure type to check for\n\nReturns\n\ntrue if closure is of type ClosureType or contains it in a tuple, false otherwise\n\nThis helper function is used to determine if CATKE or other specific closures are present in the closure configuration.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.idealized_coast-Tuple{Symbol}","page":"API Reference","title":"TimestepperTestCases.idealized_coast","text":"idealized_coast(timestepper::Symbol; arch, forced, lowres, free_surface)\n\nSet up and run the idealized coastal baroclinic adjustment test case simulation.\n\nidealized_coast(\n    timestepper;\n    arch,\n    forced,\n    lowres,\n    free_surface\n)\n\n\nArguments\n\ntimestepper: Symbol indicating the timestepper (:QuasiAdamsBashforth2 or :SplitRungeKutta3)\n\nKeyword Arguments\n\narch: Architecture to run on (default: CPU())\nforced: Whether to apply wind forcing (default: true)\nlowres: Whether to use low resolution (default: false)\nfree_surface: Free surface formulation (default: SplitExplicitFreeSurface with CFL=0.7)\n\nReturns\n\nSimulation object configured but not yet run\n\nThis function sets up the idealized coastal baroclinic adjustment test case described in the paper. The configuration features a rectangular domain with a linearly sloping bathymetry and initial meridional salinity gradient that drives baroclinic instabilities. The test case demonstrates how numerical mixing can suppress submesoscale variability, as shown in the paper.\n\nThe simulation runs for 40 days and outputs velocity, temperature, salinity, buoyancy, and variance dissipation diagnostics.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.idealized_coast_timestep-Tuple{Val{:QuasiAdamsBashforth2}}","page":"API Reference","title":"TimestepperTestCases.idealized_coast_timestep","text":"idealized_coast_timestep(::Val{timestepper})\n\nReturn the recommended time step for the idealized coast test case given a timestepper.\n\nidealized_coast_timestep(_)\n\n\nArguments\n\ntimestepper: Symbol indicating the timestepper (:QuasiAdamsBashforth2 or :SplitRungeKutta3)\n\nReturns\n\nRecommended time step [s] for the given timestepper\n\nTime steps are chosen to match computational cost between AB2 and RK schemes.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.initial_buoyancy-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.initial_buoyancy","text":"initial_buoyancy(z, p)\n\nCompute the initial buoyancy profile as a function of depth.\n\ninitial_buoyancy(z, p)\n\n\nArguments\n\nz: Vertical position [m]\np: Parameters named tuple containing ΔB (surface buoyancy gradient), h (decay scale), and Lz (domain depth)\n\nReturns\n\nInitial buoyancy [m/s²] following an exponential profile\n\nThe profile follows ΔB * (exp(z/h) - exp(-Lz/h)) / (1 - exp(-Lz/h)), which provides a stable stratification that decays exponentially with depth.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.internal_tide-Tuple{Symbol}","page":"API Reference","title":"TimestepperTestCases.internal_tide","text":"internal_tide(timestepper::Symbol; free_surface, tracer_advection)\n\nSet up and run the internal tide test case simulation.\n\ninternal_tide(timestepper; free_surface, tracer_advection)\n\n\nArguments\n\ntimestepper: Symbol indicating the timestepper (:QuasiAdamsBashforth2, :SplitRungeKutta3, or :SplitRungeKutta4)\n\nKeyword Arguments\n\nfree_surface: Free surface formulation (default: SplitExplicitFreeSurface with 60 substeps)\ntracer_advection: Tracer advection scheme (default: 7th-order WENO)\n\nReturns\n\nSimulation object after running to completion\n\nThis function sets up the internal tide test case described in the paper, which simulates tidal flow over a Gaussian seamount. The domain is initially stratified and forced by an oscillatory tidal forcing. The simulation runs for 40 days and outputs velocity, buoyancy, tracer fields, and dissipation diagnostics.\n\nThe test case isolates the role of time discretization in numerical mixing, as spatial advection plays a secondary role in this mostly linear configuration.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.internal_tide_grid-Tuple{}","page":"API Reference","title":"TimestepperTestCases.internal_tide_grid","text":"internal_tide_grid()\n\nConstruct the grid for the internal tide test case with a Gaussian seamount.\n\ninternal_tide_grid()\n\n\nReturns\n\nImmersedBoundaryGrid with periodic horizontal boundaries and a Gaussian seamount bottom\n\nThe grid spans from -L to L horizontally (periodic) and from -H to 0 vertically (bounded). A Gaussian seamount of height h₀ and width width is imposed using an immersed boundary method. The grid parameters are taken from internal_tide_parameters().\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.internal_tide_parameters-Tuple{}","page":"API Reference","title":"TimestepperTestCases.internal_tide_parameters","text":"internal_tide_parameters()\n\nReturn a named tuple containing the default parameters for the internal tide test case.\n\ninternal_tide_parameters()\n\n\nReturns\n\nNx: Number of grid points in the horizontal (x) direction\nNz: Number of grid points in the vertical (z) direction\nH: Domain depth [m]\nL: Domain half-length [m]\nh₀: Seamount height [m]\nwidth: Seamount width [m]\nT₂: Tidal period [s]\nω₂: Tidal frequency [rad/s]\nϵ: Excursion parameter (dimensionless)\nU₂: Characteristic tidal velocity [m/s]\nf: Coriolis parameter [s⁻¹]\nA₂: Tidal forcing amplitude [m/s²]\nNᵢ²: Initial stratification [s⁻²]\n\nThese parameters define a 2-kilometer deep domain with a Gaussian seamount that interacts with an oscillatory tidal forcing, as described in the paper.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.internal_tide_timestep-Tuple{Val{:QuasiAdamsBashforth2}}","page":"API Reference","title":"TimestepperTestCases.internal_tide_timestep","text":"internal_tide_timestep(::Val{timestepper})\n\nReturn the recommended time step for the internal tide test case given a timestepper.\n\ninternal_tide_timestep(_)\n\n\nArguments\n\ntimestepper: Symbol indicating the timestepper (:QuasiAdamsBashforth2, :SplitRungeKutta3, or :SplitRungeKutta4)\n\nReturns\n\nRecommended time step [s] for the given timestepper\n\nThe time steps are chosen to match computational cost between AB2 and RK schemes while maintaining stability, as described in the paper.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.load_channel-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.load_channel","text":"load_channel(folder, case_number; arch)\n\nLoad and process channel simulation output data.\n\nload_channel(folder, case_number; arch)\n\n\nArguments\n\nfolder: Directory containing the simulation output files\ncase_number: Case identifier string\narch: Architecture to load data on (default: CPU())\n\nReturns\n\nDictionary containing velocity, buoyancy, volume, and energy diagnostics\n\nThis function loads channel simulation snapshots and computes kinetic energy, mean kinetic energy, and potential energy diagnostics for equilibrated channel flow analysis.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.load_idealized_coast-NTuple{4, Any}","page":"API Reference","title":"TimestepperTestCases.load_idealized_coast","text":"load_idealized_coast(folder, closure, suffix, timestepper)\n\nLoad and process idealized coast simulation output data.\n\nload_idealized_coast(folder, closure, suffix, timestepper)\n\n\nArguments\n\nfolder: Directory containing the simulation output files\nclosure: Closure name string (e.g., \"CATKE\")\nsuffix: Filename suffix string (e.g., \"split_free_surface_\")\ntimestepper: Timestepper name string (e.g., \"SplitRungeKutta3\")\n\nReturns\n\nDictionary containing velocity, tracer, dissipation, and energy diagnostics\n\nSimilar to load_internal_tide, but includes additional fields for temperature and salinity dissipation diagnostics, as well as three-dimensional volume fields.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.load_internal_tide-Tuple{Any, Any, Any}","page":"API Reference","title":"TimestepperTestCases.load_internal_tide","text":"load_internal_tide(folder, timestepper, free_surface)\n\nLoad and process internal tide simulation output data.\n\nload_internal_tide(folder, timestepper, free_surface)\n\n\nArguments\n\nfolder: Directory containing the simulation output files\ntimestepper: Timestepper name string (e.g., \"SplitRungeKutta3\")\nfree_surface: Free surface type string (e.g., \"split_free_surface_DFB\")\n\nReturns\n\nDictionary containing:\n:u, :w, :b, :η: Velocity, buoyancy, and free surface FieldTimeSeries\n:VCCC, :VFCC, :VCCF: Volume FieldTimeSeries at different grid locations\n:Abx, :Abz: Advective buoyancy dissipation in x and z directions\n:Gbx, :Gbz: Buoyancy gradient squared in x and z directions\n:abx, :abz, :abt: Volume-averaged dissipation rates\n:gbx, :gbz, :gbt: Volume-averaged gradient squared\n:κb: Effective numerical diffusivity\n:KE, :MKE: Kinetic energy and mean kinetic energy time series\n:η2: Free surface variance time series\n:RPE, :APE: Reference and available potential energy time series\n\nThis function loads simulation output, computes volume fields accounting for free surface variations, and calculates various diagnostics used for analyzing numerical mixing.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.mask-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.mask","text":"mask(y, p)\n\nCompute the sponge layer mask function for buoyancy relaxation.\n\nmask(y, p)\n\n\nArguments\n\ny: Meridional position [m]\np: Parameters named tuple containing Ly (domain length) and Lsponge (sponge layer width)\n\nReturns\n\nMask value between 0 and 1, increasing linearly from 0 at y = Ly - Lsponge to 1 at y = Ly\n\nThis function creates a sponge layer mask used for buoyancy restoring at the northern boundary.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.print_progress-Tuple{Any}","page":"API Reference","title":"TimestepperTestCases.print_progress","text":"print_progress(sim)\n\nPrint simulation progress information including completion percentage, iteration number, simulation time, wall clock time, maximum velocity components, and next time step.\n\nprint_progress(sim)\n\n\nArguments\n\nsim: The Simulation object to print progress for.\n\nReturns\n\nnothing\n\nThis callback function is typically added to simulations using add_callback! to monitor progress during long-running simulations.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.run_channel_simulation-Tuple{}","page":"API Reference","title":"TimestepperTestCases.run_channel_simulation","text":"run_channel_simulation(; momentum_advection, tracer_advection, closure, zstar, restart_file, arch, bottom_height, timestepper, grid, initial_file, testcase)\n\nSet up and run the idealized re-entrant channel flow simulation.\n\nrun_channel_simulation(\n;\n    momentum_advection,\n    tracer_advection,\n    closure,\n    zstar,\n    restart_file,\n    arch,\n    bottom_height,\n    timestepper,\n    grid,\n    initial_file,\n    testcase\n)\n\n\nKeyword Arguments\n\nmomentum_advection: Momentum advection scheme (default: WENOVectorInvariant())\ntracer_advection: Tracer advection scheme (default: 7th-order WENO)\nclosure: Turbulence closure (default: CATKEVerticalDiffusivity)\nzstar: Whether to use z-star vertical coordinates (default: true)\nrestart_file: Optional restart file path (default: nothing)\narch: Architecture to run on (default: CPU())\nbottom_height: Optional bottom height function (default: nothing for flat bottom)\ntimestepper: Timestepper symbol (default: :SplitRungeKutta)\ngrid: Grid to use (default: default_grid(...))\ninitial_file: Optional initial condition file (default: \"tIni_80y_90L.bin\")\ntestcase: Test case identifier string (default: \"0\")\n\nReturns\n\nSimulation object after running to completion\n\nThis function sets up the idealized re-entrant channel test case described in the paper. The configuration consists of a 1000 km × 2000 km × 3 km periodic channel forced by sinusoidal wind stress and variable surface heat flux. Buoyancy is restored at the northern boundary to maintain an equilibrated state.\n\nThe simulation includes a spin-up phase followed by a long integration (40 years) with time-averaged outputs. This test case demonstrates how numerical mixing interacts with explicit physical mixing in an equilibrated configuration, as shown in the paper.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.simulation_Δt-Tuple{Val{:QuasiAdamsBashforth2}}","page":"API Reference","title":"TimestepperTestCases.simulation_Δt","text":"simulation_Δt(::Val{timestepper})\n\nReturn the recommended time step for the channel simulation given a timestepper.\n\nsimulation_Δt(_)\n\n\nArguments\n\ntimestepper: Symbol indicating the timestepper (:QuasiAdamsBashforth2, :SplitRungeKutta3, or :SplitRungeKutta6)\n\nReturns\n\nRecommended time step [s] for the given timestepper\n\nTime steps are chosen to match computational cost between different timesteppers.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.tidal_forcing-NTuple{4, Any}","page":"API Reference","title":"TimestepperTestCases.tidal_forcing","text":"tidal_forcing(x, z, t, p)\n\nCompute the tidal forcing amplitude at position (x, z) and time t.\n\ntidal_forcing(x, z, t, p)\n\n\nArguments\n\nx: Horizontal position [m]\nz: Vertical position [m]\nt: Time [s]\np: Parameters named tuple containing A₂ (forcing amplitude) and ω₂ (tidal frequency)\n\nReturns\n\nForcing amplitude [m/s²] as a function of time only: A₂ * sin(ω₂ * t)\n\nThis function implements a simple oscillatory tidal forcing that varies sinusoidally in time with amplitude A₂ and frequency ω₂.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.u_stress-NTuple{6, Any}","page":"API Reference","title":"TimestepperTestCases.u_stress","text":"u_stress(i, j, grid, clock, model_fields, p)\n\nCompute the zonal wind stress at the surface.\n\nu_stress(i, j, grid, clock, model_fields, p)\n\n\nArguments\n\ni, j: Grid indices\ngrid: Grid object\nclock: Simulation clock\nmodel_fields: Model fields\np: Parameters named tuple containing τ (stress magnitude) and Ly (domain length)\n\nReturns\n\nZonal wind stress [m²/s²] following a sine profile: -τ * sin(π * y / Ly)\n\nThis implements a sinusoidal wind stress profile that drives zonal flow, with maximum stress at the domain center and zero at the boundaries.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.wind_stress-NTuple{6, Any}","page":"API Reference","title":"TimestepperTestCases.wind_stress","text":"wind_stress(i, j, grid, clock, fields, p)\n\nCompute the wind stress forcing at grid point (i, j).\n\nwind_stress(i, j, grid, clock, fields, p)\n\n\nArguments\n\ni, j: Grid indices\ngrid: Grid object\nclock: Simulation clock\nfields: Model fields\np: Parameters named tuple containing τ₀ (stress amplitude) and f (frequency)\n\nReturns\n\nWind stress [m²/s²] that activates after 4 days: τ₀ * sin(f * t) if t > 4 days, else 0\n\nThis function implements a time-dependent wind stress that begins after a 4-day spin-up period and oscillates with frequency f and amplitude τ₀.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation-Tuple{Any}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation","text":"(ϵ::BuoyancyVarianceDissipation)(model)\n\nCompute buoyancy variance dissipation and update flux caches for the next time step.\n\nBuoyancyVarianceDissipation(grid; Uⁿ⁻¹, Uⁿ)\n\n\nArguments\n\nmodel: The HydrostaticFreeSurfaceModel containing temperature and salinity tracers\n\nReturns\n\nnothing (modifies ϵ in place)\n\nThis function is called as a simulation callback to compute the advective dissipation of buoyancy variance at each time step. It first computes dissipation from previously cached fluxes, then updates the flux caches for the next time step.\n\nThe model must have :T and :S tracers to compute buoyancy.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.c_grid_vector-Tuple{Any}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.c_grid_vector","text":"c_grid_vector(grid)\n\nCreate a named tuple of C-grid vector fields (x, y, z components at face locations).\n\nc_grid_vector(grid)\n\n\nArguments\n\ngrid: Grid on which to create the fields\n\nReturns\n\nNamed tuple with x, y, z fields at XFace, YFace, and ZFace locations respectively\n\nThis helper function creates the vector fields needed to store advective fluxes and dissipation rates at their proper staggered grid locations.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.cache_fluxes!-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.cache_fluxes!","text":"cache_fluxes!(dissipation, model)\n\nCache advective fluxes and update velocity fields for dissipation computation.\n\ncache_fluxes!(dissipation, model)\n\n\nArguments\n\ndissipation: BuoyancyVarianceDissipation object\nmodel: The model containing velocities and tracers\n\nReturns\n\nnothing (modifies dissipation in place)\n\nThis function updates the velocity fields (Uⁿ, Uⁿ⁻¹) and caches the advective buoyancy fluxes (Fⁿ, Fⁿ⁻¹) needed for computing dissipation at the next time step. The caching procedure depends on the timestepper type and stage.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.compute_dissipation!-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.compute_dissipation!","text":"compute_dissipation!(dissipation, model)\n\nCompute the numerical dissipation of buoyancy variance from previously calculated advective fluxes.\n\ncompute_dissipation!(dissipation, model)\n\n\nArguments\n\ndissipation: BuoyancyVarianceDissipation object containing cached fluxes\nmodel: The model containing tracers and timestepper information\n\nReturns\n\nnothing (modifies dissipation.advective_production in place)\n\nThe dissipation is computed using the formulation:\n\nA = 2 * δc★ * F - U δc²  # For advective dissipation\n\nwhere F is the flux associated with advection, U is the advecting velocity, c★ and c² are functions of the buoyancy field.\n\nFor multi-stage timesteppers, the fluxes and velocities must account for the substepping procedure. For AB2: F = 1.5 Fⁿ - 0.5 Fⁿ⁻¹ and U = 1.5 Uⁿ - 0.5 Uⁿ⁻¹. For RK schemes, the fluxes from the appropriate substep are used.\n\nThis method is adapted from the exact variance budget methodology described in the paper's appendix.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.finally_cache_fluxes!-Tuple{Any, Any}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.finally_cache_fluxes!","text":"finally_cache_fluxes!(dissipation, model)\n\nCache advective buoyancy fluxes from temperature and salinity tracers.\n\nfinally_cache_fluxes!(dissipation, model)\n\n\nArguments\n\ndissipation: BuoyancyVarianceDissipation object\nmodel: The model containing tracers and advection scheme\n\nReturns\n\nnothing (modifies dissipation.advective_fluxes in place)\n\nThis function computes the advective fluxes of buoyancy by combining temperature and salinity fluxes using the linear equation of state. The fluxes are computed at face locations and cached for use in dissipation computation.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.flatten_dissipation_fields-Tuple{TimestepperTestCases.BuoyancyVarianceDissipationComputations.BuoyancyVarianceDissipation}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.flatten_dissipation_fields","text":"flatten_dissipation_fields(t::BuoyancyVarianceDissipation)\n\nFlatten the dissipation fields into a named tuple for output.\n\nflatten_dissipation_fields(t)\n\n\nArguments\n\nt: BuoyancyVarianceDissipation object\n\nReturns\n\nNamed tuple containing Abx, Aby, Abz fields representing advective buoyancy dissipation in the x, y, and z directions respectively\n\nThis function extracts the dissipation fields from the internal C-grid vector structure into a flat named tuple suitable for use as simulation outputs.\n\n\n\n\n\n","category":"method"},{"location":"api_reference/#TimestepperTestCases.BuoyancyVarianceDissipationComputations.flux_parameters-Tuple{Any}","page":"API Reference","title":"TimestepperTestCases.BuoyancyVarianceDissipationComputations.flux_parameters","text":"flux_parameters(grid)\n\nCompute kernel parameters for flux computation based on grid topology.\n\nflux_parameters(grid)\n\n\nArguments\n\ngrid: Grid object\n\nReturns\n\nKernelParameters object with appropriate index ranges for flux computation\n\nThis function determines the correct index ranges for computing fluxes at face locations, accounting for flat (1D/2D) dimensions in the grid topology.\n\n\n\n\n\n","category":"method"},{"location":"stability/#Linear-Stability-Analysis","page":"Stability Analysis","title":"Linear Stability Analysis","text":"This package includes tools for analyzing the linear stability of coupled barotropic-baroclinic systems with different time-stepping schemes. The stability analysis extends the modal decomposition approach to multi-stage Runge-Kutta schemes.","category":"section"},{"location":"stability/#Overview","page":"Stability Analysis","title":"Overview","text":"The stability analysis decomposes the system into barotropic and baroclinic modes and computes eigenvalues of the evolution matrix. For a two-dimensional (x, z) hydrostatic system with no rotation, the analysis considers:\n\nBarotropic mode: Depth-independent mode\nFirst baroclinic mode: Projection onto vertical mode φ = √2 cos(πz/H)","category":"section"},{"location":"stability/#Key-Findings","page":"Stability Analysis","title":"Key Findings","text":"The analysis reveals critical constraints for split-explicit RK implementations:\n\nTransport Velocity Choice: Split-explicit RK schemes require the averaged barotropic transport velocity (w★) for tracer advection, not the previous substep's velocity (w^m), to maintain baroclinic stability.\nStability Comparison: RK3-SE with correct coupling shows baroclinic mode amplification similar to the single-mode RK analysis, while incorrect coupling (w^m) leads to instabilities.\nImplicit vs. Split-Explicit: RK3-IM shows increased dissipation compared to RK3-SE for both barotropic and baroclinic modes, as expected from the implicit free surface treatment.","category":"section"},{"location":"stability/#Using-the-Stability-Analysis","page":"Stability Analysis","title":"Using the Stability Analysis","text":"The stability analysis is implemented in the linear_stability.ipynb notebook. Key functions compute:\n\nEvolution matrices for different timesteppers\nEigenvalues for barotropic and baroclinic modes\nAmplification factors as functions of CFL number and stratification","category":"section"},{"location":"stability/#Running-the-Analysis","page":"Stability Analysis","title":"Running the Analysis","text":"# See linear_stability.ipynb for full implementation\n# The notebook computes eigenvalues for:\n# - AB2-SE\n# - RK3-SE with w^m (incorrect)\n# - RK3-SE with w★ (correct)\n# - RK3-IM","category":"section"},{"location":"stability/#Mathematical-Framework","page":"Stability Analysis","title":"Mathematical Framework","text":"The analysis linearizes the primitive equations around a rest state and decomposes variables as:\n\nY(x z t) = sum_q=0^infty Y_q(x t) M_q(z)\n\nwhere M_0 = 1 (barotropic) and M_1 = √2 cos(πz/H) (first baroclinic).\n\nThe discrete evolution matrix is constructed from the time-stepping scheme, and eigenvalues determine stability:\n\n|λ| < 1: Stable (dissipative)\n|λ| = 1: Neutral (non-dissipative)\n|λ| > 1: Unstable","category":"section"},{"location":"stability/#Results","page":"Stability Analysis","title":"Results","text":"The stability analysis shows:\n\nBaroclinic Mode: RK3-SE with w★ maintains stability similar to single-mode RK, while w^m leads to growing instabilities with increasing stratification.\nBarotropic Mode: Both RK3-SE and RK3-IM maintain stable barotropic modes, with RK3-IM showing more dissipation.\nCFL Dependence: RK3 schemes remain stable over larger CFL ranges than AB2, consistent with the amplification factor analysis.","category":"section"},{"location":"stability/#References","page":"Stability Analysis","title":"References","text":"The analysis methodology is described in detail in the paper, extending the approach of Demange et al. (2019) to multi-stage schemes. See the paper's Section 4 for the complete derivation.","category":"section"},{"location":"diagnostics/#Diagnostics","page":"Diagnostics","title":"Diagnostics","text":"This package provides comprehensive diagnostics for quantifying numerical mixing and assessing the performance of time-stepping schemes. The diagnostics are based on exact variance budget methodology that is exact locally in both space and time.","category":"section"},{"location":"diagnostics/#Variance-Budget-Methodology","page":"Diagnostics","title":"Variance Budget Methodology","text":"The variance budget approach quantifies numerical mixing by tracking the dissipation of tracer variance. For a tracer c, the variance budget reads:\n\nfracpartial c^2partial t = -2c nabla cdot (mathbfu c) + textsources - textsinks\n\nThe numerical dissipation P is computed as:\n\nP = 2 F_star delta c - U_star delta c^2\n\nwhere F_\\star is the effective advective flux and U_\\star is the effective advective velocity, computed differently for AB2 and RK schemes.","category":"section"},{"location":"diagnostics/#For-AB2","page":"Diagnostics","title":"For AB2","text":"F_star = left(frac32 + epsilonright) F^n - left(frac12 + epsilonright) F^n-1\n\nU_star = left(frac32 + epsilonright) U^n - left(frac12 + epsilonright) U^n-1","category":"section"},{"location":"diagnostics/#For-RK-Schemes","page":"Diagnostics","title":"For RK Schemes","text":"For low-storage RK schemes, only the last substep contributes to the budget:\n\nF_star = F^M-1 quad U_star = U^M-1\n\nwhere M-1 indicates the second-to-last substep.","category":"section"},{"location":"diagnostics/#Numerical-Diffusivity","page":"Diagnostics","title":"Numerical Diffusivity","text":"The effective numerical diffusivity is computed as:\n\nkappa_textnum = frac12 fracoverlineP_x + overlineP_y + overlineP_zoverlinenabla b^2\n\nwhere the overbar indicates an averaging operator (varies by test case) and P_x, P_y, P_z are the dissipation rates in each direction.","category":"section"},{"location":"diagnostics/#Reference-Potential-Energy-(RPE)","page":"Diagnostics","title":"Reference Potential Energy (RPE)","text":"Reference potential energy represents the minimum potential energy achievable by adiabatic re-sorting of the density field. It quantifies irreversible mixing:\n\ntextRPE = int_V rho z^star dV\n\nwhere z^\\star is the re-sorted height computed by sorting buoyancy and computing cumulative volume distribution.","category":"section"},{"location":"diagnostics/#Available-Potential-Energy-(APE)","page":"Diagnostics","title":"Available Potential Energy (APE)","text":"Available potential energy is the difference between actual and reference potential energy:\n\ntextAPE = int_V rho (z - z^star) dV\n\nAPE represents the energy available for conversion to kinetic energy through baroclinic instabilities.","category":"section"},{"location":"diagnostics/#Using-Diagnostics","page":"Diagnostics","title":"Using Diagnostics","text":"","category":"section"},{"location":"diagnostics/#During-Simulation","page":"Diagnostics","title":"During Simulation","text":"Add diagnostics as callbacks:\n\nusing TimestepperTestCases\nusing Oceananigans.Models.VarianceDissipationComputations\n\n# For buoyancy variance dissipation\nϵb = BuoyancyVarianceDissipation(grid)\nadd_callback!(simulation, ϵb, IterationInterval(1))\n\n# For tracer variance dissipation (internal tide)\nadd_callback!(simulation, compute_tracer_dissipation!, IterationInterval(1))","category":"section"},{"location":"diagnostics/#Post-Processing","page":"Diagnostics","title":"Post-Processing","text":"Load and compute diagnostics from saved output:\n\n# Load case\ncase = load_internal_tide(\"output/\", \"SplitRungeKutta3\", \"split_free_surface_DFB\")\n\n# Access pre-computed diagnostics\ncase[:RPE]  # Reference potential energy time series\ncase[:APE]  # Available potential energy time series\ncase[:κb]   # Numerical diffusivity FieldTimeSeries\ncase[:abx]  # Volume-averaged x-direction dissipation\ncase[:abz]  # Volume-averaged z-direction dissipation","category":"section"},{"location":"diagnostics/#Computing-RPE/APE-Manually","page":"Diagnostics","title":"Computing RPE/APE Manually","text":"using TimestepperTestCases\n\n# From a case dictionary\nrpe_ape = compute_rpe_density(case)\nrpe_ape.rpe  # RPE time series\nrpe_ape.ape  # APE time series\n\n# From fields directly\nzstar = calculate_z★_diagnostics(b_field, vol_field)\nrpe_ape_fields = compute_rpe_density(b_field, vol_field)","category":"section"},{"location":"diagnostics/#Interpretation","page":"Diagnostics","title":"Interpretation","text":"Low RPE increase: Indicates less irreversible mixing\nHigh APE: Indicates more energy available for instabilities\nLow numerical diffusivity: Indicates less spurious mixing from discretization\nκphys / κnum > 1: Physical processes dominate over numerical artifacts\n\nAs shown in the paper, RK3 schemes consistently show:\n\nLower numerical diffusivity than AB2\nLess RPE increase (less irreversible mixing)\nHigher APE (more energy available for instabilities)\nBetter preservation of stratification and mesoscale variability","category":"section"},{"location":"getting_started/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"","category":"section"},{"location":"getting_started/#Installation","page":"Getting Started","title":"Installation","text":"Install TimestepperTestCases.jl using Julia's package manager:\n\nusing Pkg\nPkg.add(\"TimestepperTestCases\")\n\nOr add it directly from the GitHub repository:\n\nusing Pkg\nPkg.add(url=\"https://github.com/simone-silvestri/TimestepperTestCases.jl\")","category":"section"},{"location":"getting_started/#Basic-Usage","page":"Getting Started","title":"Basic Usage","text":"After installation, load the package:\n\nusing TimestepperTestCases","category":"section"},{"location":"getting_started/#Running-a-Test-Case","page":"Getting Started","title":"Running a Test Case","text":"The package provides three main test case functions:","category":"section"},{"location":"getting_started/#Internal-Tide","page":"Getting Started","title":"Internal Tide","text":"using TimestepperTestCases\n\n# Run with RK3 and split-explicit free surface\nsim = internal_tide(:SplitRungeKutta3)\n\n# Or with AB2\nsim = internal_tide(:QuasiAdamsBashforth2)","category":"section"},{"location":"getting_started/#Idealized-Coast","page":"Getting Started","title":"Idealized Coast","text":"# Run with RK3\nsim = idealized_coast(:SplitRungeKutta3; forced=true, lowres=false)\n\n# Run without forcing\nsim = idealized_coast(:SplitRungeKutta3; forced=false)","category":"section"},{"location":"getting_started/#Channel-Simulation","page":"Getting Started","title":"Channel Simulation","text":"# Run channel simulation with default settings\nsim = run_channel_simulation(timestepper=:SplitRungeKutta3)\n\n# Or customize closure and grid\nsim = run_channel_simulation(\n    timestepper=:SplitRungeKutta3,\n    closure=default_closure(),\n    zstar=true\n)","category":"section"},{"location":"getting_started/#Loading-Simulation-Output","page":"Getting Started","title":"Loading Simulation Output","text":"After running a simulation, load the output data:\n\n# For internal tide\ncase = load_internal_tide(\"output_folder/\", \"SplitRungeKutta3\", \"split_free_surface_DFB\")\n\n# Access diagnostics\ncase[:KE]   # Kinetic energy time series\ncase[:RPE]  # Reference potential energy\ncase[:APE]  # Available potential energy\ncase[:κb]   # Numerical diffusivity","category":"section"},{"location":"getting_started/#Dependencies","page":"Getting Started","title":"Dependencies","text":"TimestepperTestCases.jl requires:\n\nJulia 1.9 or later\nOceananigans.jl (for the ocean model)\nJLD2 (for reading/writing simulation output)\nVarious plotting and analysis packages (see Project.toml)","category":"section"},{"location":"getting_started/#Next-Steps","page":"Getting Started","title":"Next Steps","text":"Learn about the experiments in detail\nUnderstand the diagnostics used to quantify numerical mixing\nExplore the notebooks for reproducing figures","category":"section"},{"location":"notebooks/#Notebooks","page":"Notebooks","title":"Notebooks","text":"This repository includes Jupyter notebooks for reproducing figures and analysis from the paper. All notebooks are located in the notebooks/ directory.","category":"section"},{"location":"notebooks/#Available-Notebooks","page":"Notebooks","title":"Available Notebooks","text":"","category":"section"},{"location":"notebooks/#Figure-Generation","page":"Notebooks","title":"Figure Generation","text":"figure_1.ipynb: Generates Figure 1 from the paper (amplification factors)\nfigure_2.ipynb: Generates Figure 2 from the paper (linear stability analysis)","category":"section"},{"location":"notebooks/#Results-Analysis","page":"Notebooks","title":"Results Analysis","text":"Results_internal_tide.ipynb: Analysis and visualization of internal tide results\nResults_idealized_coast.ipynb: Analysis and visualization of idealized coast results\nResults_channel.ipynb: Analysis and visualization of channel simulation results","category":"section"},{"location":"notebooks/#Stability-Analysis","page":"Notebooks","title":"Stability Analysis","text":"linear_stability.ipynb: Linear stability analysis for coupled barotropic-baroclinic modes","category":"section"},{"location":"notebooks/#Running-Notebooks","page":"Notebooks","title":"Running Notebooks","text":"","category":"section"},{"location":"notebooks/#Prerequisites","page":"Notebooks","title":"Prerequisites","text":"Install required packages:\n\nusing Pkg\nPkg.add([\"IJulia\", \"Plots\", \"CairoMakie\", \"JLD2\"])","category":"section"},{"location":"notebooks/#Starting-Jupyter","page":"Notebooks","title":"Starting Jupyter","text":"using IJulia\nnotebook()\n\nOr from the command line:\n\njulia -e \"using IJulia; notebook()\"","category":"section"},{"location":"notebooks/#Running-a-Notebook","page":"Notebooks","title":"Running a Notebook","text":"Navigate to the notebooks/ directory\nOpen the desired notebook in Jupyter\nEnsure simulation output files are in the expected locations (see notebook comments)\nRun all cells","category":"section"},{"location":"notebooks/#Notebook-Descriptions","page":"Notebooks","title":"Notebook Descriptions","text":"","category":"section"},{"location":"notebooks/#Figure-1:-Amplification-Factors","page":"Notebooks","title":"Figure 1: Amplification Factors","text":"This notebook reproduces the amplification factor analysis comparing AB2 and RK schemes for linear advection. It shows how RK schemes maintain amplification factors closer to unity over a wider CFL range, indicating less implicit dissipation.","category":"section"},{"location":"notebooks/#Figure-2:-Linear-Stability","page":"Notebooks","title":"Figure 2: Linear Stability","text":"This notebook reproduces the linear stability analysis showing eigenvalues for the coupled barotropic-baroclinic system. It demonstrates the importance of using the averaged barotropic transport velocity (w★) for tracer advection in split-explicit RK schemes.","category":"section"},{"location":"notebooks/#Results-Notebooks","page":"Notebooks","title":"Results Notebooks","text":"These notebooks load simulation output and generate diagnostic plots including:\n\nTime series of kinetic energy, RPE, APE\nVertical profiles of numerical diffusivity\nSpatial snapshots of velocity, buoyancy, and dissipation fields\nPower spectra\nMean fields and differences between timesteppers","category":"section"},{"location":"notebooks/#Linear-Stability-Notebook","page":"Notebooks","title":"Linear Stability Notebook","text":"This notebook implements the modal decomposition analysis described in the paper, computing eigenvalues for different coupling strategies and demonstrating stability constraints for multi-stage schemes.","category":"section"},{"location":"notebooks/#Data-Requirements","page":"Notebooks","title":"Data Requirements","text":"Most notebooks require simulation output files. Run the simulations first:\n\nusing TimestepperTestCases\n\n# Run simulations\ninternal_tide(:SplitRungeKutta3)\ninternal_tide(:QuasiAdamsBashforth2)\n\nidealized_coast(:SplitRungeKutta3)\nidealized_coast(:QuasiAdamsBashforth2)\n\nrun_channel_simulation(timestepper=:SplitRungeKutta3)\nrun_channel_simulation(timestepper=:QuasiAdamsBashforth2)\n\nOutput files should be in the directories expected by the notebooks (typically internal_tide/, idealized_coast/, and channel-simulation/).","category":"section"},{"location":"notebooks/#Customization","page":"Notebooks","title":"Customization","text":"Notebooks can be customized to:\n\nCompare different timesteppers\nAnalyze different time periods\nGenerate custom visualizations\nCompute additional diagnostics\n\nModify the notebook code as needed for your analysis.","category":"section"},{"location":"experiments/idealized_coast/#Idealized-Coastal-Baroclinic-Adjustment","page":"Idealized Coast","title":"Idealized Coastal Baroclinic Adjustment","text":"The idealized coast test case simulates baroclinic adjustment in a coastal domain with a sloping bottom and initial meridional salinity gradient. This configuration introduces nonlinearities and demonstrates how numerical mixing can suppress submesoscale variability.","category":"section"},{"location":"experiments/idealized_coast/#Configuration","page":"Idealized Coast","title":"Configuration","text":"The domain is 192 km × 192 km × 103 m with a linearly sloping bathymetry (5 m deep at the southern edge, reaching full depth at 96 km). The initial hydrography features a meridional salinity gradient that drives baroclinic instabilities.","category":"section"},{"location":"experiments/idealized_coast/#Parameters","page":"Idealized Coast","title":"Parameters","text":"using TimestepperTestCases\n\n# Run with default settings (forced, high resolution)\nsim = idealized_coast(:SplitRungeKutta3)\n\n# Low resolution version\nsim = idealized_coast(:SplitRungeKutta3; lowres=true)\n\n# Unforced version (no wind stress)\nsim = idealized_coast(:SplitRungeKutta3; forced=false)\n\nKey parameters:\n\nDomain: 192 km × 192 km × 103 m\nGrid: 250 × 250 × 40 points (high res) or 96 × 96 × 40 (low res)\nBottom slope: Linear from 5 m to 103 m depth\nInitial stratification: N² = 10⁻⁴ s⁻²\nMeridional gradient: M² = 1.2×10⁻⁶ s⁻² (for y < 50 km)\nTime step: 5 minutes (AB2) or 10 minutes (RK3)\nSimulation duration: 40 days\nWind forcing: Oscillatory stress after 4-day spin-up (if forced=true)","category":"section"},{"location":"experiments/idealized_coast/#Running-the-Simulation","page":"Idealized Coast","title":"Running the Simulation","text":"using TimestepperTestCases\n\n# Standard forced case\nsim = idealized_coast(:SplitRungeKutta3; forced=true, lowres=false)\n\n# Customize free surface\nsim = idealized_coast(:SplitRungeKutta3; \n                      free_surface=ImplicitFreeSurface(grid))","category":"section"},{"location":"experiments/idealized_coast/#Output-Fields","page":"Idealized Coast","title":"Output Fields","text":"The simulation outputs:\n\nu, v, w: Velocity components\nT, S: Temperature and salinity\nb: Buoyancy\nη: Free surface elevation\nAbx, Aby, Abz: Advective buoyancy dissipation (x, y, z)\nATx, ATy, ATz: Advective temperature dissipation\nASx, ASy, ASz: Advective salinity dissipation\nGbx, Gby, Gbz: Buoyancy gradient squared\nGTx, GTy, GTz: Temperature gradient squared\nGSx, GSy, GSz: Salinity gradient squared\nκu, κc: CATKE diffusivities (if forced)","category":"section"},{"location":"experiments/idealized_coast/#Expected-Results","page":"Idealized Coast","title":"Expected Results","text":"As shown in the paper:\n\nRK3-SE maintains sharper stratification and stronger submesoscale variability\nAB2-SE shows reduced eddy activity and weaker stratification\nHorizontal dissipation dominates over vertical dissipation\nRK3-SE preserves more kinetic energy variance across scales","category":"section"},{"location":"experiments/idealized_coast/#Loading-and-Analyzing-Results","page":"Idealized Coast","title":"Loading and Analyzing Results","text":"# Load results\ncase = load_idealized_coast(\"output_folder/\", \"CATKE\", \"split_free_surface_\", \"SplitRungeKutta3\")\n\n# Access diagnostics\ncase[:KE]   # Kinetic energy\ncase[:MKE]  # Mean kinetic energy\ncase[:RPE]  # Reference potential energy\ncase[:APE]  # Available potential energy\ncase[:abx], case[:aby], case[:abz]  # Volume-averaged dissipation\ncase[:gbx], case[:gby], case[:gbz]  # Volume-averaged gradient squared","category":"section"},{"location":"experiments/idealized_coast/#Physical-Interpretation","page":"Idealized Coast","title":"Physical Interpretation","text":"This test case demonstrates that numerical mixing can suppress physical instabilities. The reduced dissipation in RK3-SE allows baroclinic instabilities to develop more fully, preserving submesoscale variability that AB2-SE suppresses. The horizontal dissipation dominates because eddy activity occurs primarily at the surface where horizontal gradients are strongest.","category":"section"},{"location":"experiments/channel/#Equilibrated-Channel-Flow","page":"Channel Flow","title":"Equilibrated Channel Flow","text":"The channel simulation is an idealized re-entrant periodic channel forced by wind stress and surface heat flux. Unlike the transient configurations, this case relaxes toward statistical equilibrium, allowing assessment of how time-stepping schemes affect the equilibrated solution and how numerical mixing interacts with parameterized physical diffusivity.","category":"section"},{"location":"experiments/channel/#Configuration","page":"Channel Flow","title":"Configuration","text":"The domain is 1000 km × 2000 km × 3 km with periodic zonal boundaries and bounded meridional boundaries. The channel is forced by sinusoidal wind stress and variable surface heat flux, with buoyancy restored at the northern boundary.","category":"section"},{"location":"experiments/channel/#Parameters","page":"Channel Flow","title":"Parameters","text":"using TimestepperTestCases\n\n# Run with default settings\nsim = run_channel_simulation(timestepper=:SplitRungeKutta3)\n\n# Customize closure\nsim = run_channel_simulation(\n    timestepper=:SplitRungeKutta3,\n    closure=default_closure(),\n    zstar=true\n)\n\n# Use custom grid\nsim = run_channel_simulation(\n    timestepper=:SplitRungeKutta3,\n    grid=custom_grid\n)\n\nKey parameters:\n\nDomain: 1000 km × 2000 km × 3 km\nGrid: 200 × 400 × 90 points (non-uniform vertical spacing)\nTime step: 5 minutes (AB2), 10 minutes (RK3), or 20 minutes (RK6)\nSimulation duration: 40 years (last 5 years averaged)\nClosure: CATKE with background diffusivity κ = 10⁻⁵ m²/s, ν = 10⁻⁴ m²/s\nWind stress: Sinusoidal profile τ = -0.1/ρ * sin(π * y / Ly)\nHeat flux: Variable profile Qᵇ * cos(3π * y / Ly) for y < 5/6 * Ly","category":"section"},{"location":"experiments/channel/#Running-the-Simulation","page":"Channel Flow","title":"Running the Simulation","text":"using TimestepperTestCases\n\n# Standard run\nsim = run_channel_simulation(timestepper=:SplitRungeKutta3)\n\n# Restart from checkpoint\nsim = run_channel_simulation(\n    timestepper=:SplitRungeKutta3,\n    restart_file=\"channel_checkpoint_0.jld2\"\n)","category":"section"},{"location":"experiments/channel/#Output-Fields","page":"Channel Flow","title":"Output Fields","text":"The simulation outputs:\n\nu, v, w: Velocity components\nb: Buoyancy\nη: Free surface elevation\nAbx, Aby, Abz: Advective buoyancy dissipation\nGbx, Gby, Gbz: Buoyancy gradient squared\nSnapshots: Every 360 days\nAverages: 5-year averages","category":"section"},{"location":"experiments/channel/#Expected-Results","page":"Channel Flow","title":"Expected Results","text":"As shown in the paper:\n\nRK3-SE achieves κ_phys / κ_num > 2 throughout most of the water column\nAB2-SE hovers around κ_phys / κ_num ≈ 1\nRK3-UP (with low-order advection) shows κ_phys / κ_num < 1\nRK3-SE produces cooler equilibrated solutions (less spurious mixing)\nHorizontal numerical diffusivity dominates over vertical","category":"section"},{"location":"experiments/channel/#Loading-and-Analyzing-Results","page":"Channel Flow","title":"Loading and Analyzing Results","text":"# Load channel results\ncase = load_channel(\"output_folder/\", \"0\"; arch=CPU())\n\n# Access diagnostics\ncase[:KE]   # Kinetic energy time series\ncase[:MKE]  # Mean kinetic energy\ncase[:RPE]  # Reference potential energy\ncase[:APE]  # Available potential energy\ncase[:η2]   # Free surface variance","category":"section"},{"location":"experiments/channel/#Physical-Interpretation","page":"Channel Flow","title":"Physical Interpretation","text":"This test case demonstrates the critical importance of maintaining κ_phys / κ_num > 1 for long-term climate integrations. When numerical mixing overwhelms physical mixing (as in RK3-UP or near-surface AB2-SE), the equilibrated solution is significantly warmer and less stratified. RK3-SE maintains physical processes as dominant throughout most of the water column, which is essential for preserving stratification and mesoscale variability in climate applications.","category":"section"},{"location":"#TimestepperTestCases.jl","page":"Home","title":"TimestepperTestCases.jl","text":"(Image: Stable) (Image: Dev) (Image: Build Status) (Image: Coverage)\n\nTimestepperTestCases.jl is a Julia package that provides test cases and diagnostics for evaluating time-stepping schemes in free-surface ocean models. This repository complements the paper \"A Low-Storage Runge-Kutta Framework for Non-Linear Free-Surface Ocean Models\" by providing:\n\nThree idealized test cases spanning linear to fully turbulent regimes\nExact variance budget diagnostics for quantifying numerical mixing\nLinear stability analysis tools\nNotebooks for reproducing figures and analysis from the paper","category":"section"},{"location":"#Overview","page":"Home","title":"Overview","text":"This package implements test cases designed to highlight differences in performance between time discretization schemes, particularly comparing low-storage Runge-Kutta (RK) methods with Adams-Bashforth (AB2) schemes. The test cases include:\n\nInternal Tide: A linear test case isolating temporal discretization effects\nIdealized Coastal Baroclinic Adjustment: A nonlinear case demonstrating submesoscale variability\nEquilibrated Channel Flow: A long-term equilibrated configuration showing interaction between numerical and physical mixing","category":"section"},{"location":"#Key-Features","page":"Home","title":"Key Features","text":"Exact Variance Budgets: Diagnostics that are exact locally in both space and time, enabling quantification of numerical mixing from time discretization\nMultiple Timesteppers: Support for QuasiAdamsBashforth2, SplitRungeKutta3, and SplitRungeKutta4\nFree Surface Options: Both implicit and split-explicit free surface formulations\nComprehensive Diagnostics: Reference potential energy (RPE), available potential energy (APE), kinetic energy, and numerical diffusivity diagnostics","category":"section"},{"location":"#Quick-Links","page":"Home","title":"Quick Links","text":"Getting Started - Installation and basic usage\nExperiments - Detailed descriptions of the three test cases\nDiagnostics - Understanding variance budgets and numerical mixing\nStability Analysis - Linear stability analysis tools\nNotebooks - Reproducing figures and analysis\nAPI Reference - Complete function documentation","category":"section"},{"location":"#Citation","page":"Home","title":"Citation","text":"If you use this package in your research, please cite the associated paper:\n\n@article{silvestri2025timestepper,\n  title={A Low-Storage Runge-Kutta Framework for Non-Linear Free-Surface Ocean Models},\n  author={Silvestri, Simone and others},\n  journal={Journal of Advances in Modeling Earth Systems},\n  year={2025}\n}","category":"section"},{"location":"#Related-Packages","page":"Home","title":"Related Packages","text":"This package builds on Oceananigans.jl, a fast, friendly, flexible ocean-flavored fluid dynamics package for CPUs and GPUs.","category":"section"},{"location":"experiments/internal_tide/#Internal-Tide-Test-Case","page":"Internal Tide","title":"Internal Tide Test Case","text":"The internal tide test case simulates tidal flow over a Gaussian seamount in a stratified ocean. This configuration isolates the role of time discretization, as spatial advection plays a secondary role in this mostly linear regime.","category":"section"},{"location":"experiments/internal_tide/#Configuration","page":"Internal Tide","title":"Configuration","text":"The domain spans 2000 km horizontally (periodic) and 2 km vertically (bounded), with a Gaussian seamount of height 250 m and width 20 km. The domain is initially stratified with N² = 10⁻⁴ s⁻² and forced by an oscillatory tidal forcing.","category":"section"},{"location":"experiments/internal_tide/#Parameters","page":"Internal Tide","title":"Parameters","text":"using TimestepperTestCases\n\n# Get default parameters\nparams = internal_tide_parameters()\n\nKey parameters:\n\nDomain: 2000 km × 2 km\nGrid: 256 × 128 points\nSeamount: 250 m height, 20 km width\nTidal period: 12.421 hours (M₂ tide)\nInitial stratification: N² = 10⁻⁴ s⁻²\nTime step: 5 minutes (AB2) or 10 minutes (RK3)\nSimulation duration: 40 days","category":"section"},{"location":"experiments/internal_tide/#Running-the-Simulation","page":"Internal Tide","title":"Running the Simulation","text":"using TimestepperTestCases\n\n# Run with RK3 and split-explicit free surface\nsim = internal_tide(:SplitRungeKutta3)\n\n# Or with implicit free surface\nsim = internal_tide(:SplitRungeKutta3; \n                    free_surface=ImplicitFreeSurface(internal_tide_grid()))\n\n# Run with AB2 for comparison\nsim = internal_tide(:QuasiAdamsBashforth2)","category":"section"},{"location":"experiments/internal_tide/#Output-Fields","page":"Internal Tide","title":"Output Fields","text":"The simulation outputs:\n\nu, w: Horizontal and vertical velocities\nb, c: Buoyancy and passive tracer\nη: Free surface elevation\nΔtc², Δtb²: Tracer variance dissipation rates\nGbx, Gbz, Gcx, Gcz: Gradient squared fields","category":"section"},{"location":"experiments/internal_tide/#Expected-Results","page":"Internal Tide","title":"Expected Results","text":"As shown in the paper, RK3 schemes retain more energy than AB2:\n\nSharper velocity structures (u′, w)\nBetter preserved stratification (N²)\nLower numerical diffusivity throughout the water column\nHigher kinetic energy and available potential energy","category":"section"},{"location":"experiments/internal_tide/#Loading-and-Analyzing-Results","page":"Internal Tide","title":"Loading and Analyzing Results","text":"# Load results\ncase = load_internal_tide(\"output_folder/\", \"SplitRungeKutta3\", \"split_free_surface_DFB\")\n\n# Access time series\ncase[:KE]   # Kinetic energy\ncase[:RPE]  # Reference potential energy (irreversible mixing)\ncase[:APE]  # Available potential energy\ncase[:abx]  # Volume-averaged x-direction dissipation\ncase[:abz]  # Volume-averaged z-direction dissipation\ncase[:κb]   # Effective numerical diffusivity","category":"section"},{"location":"experiments/internal_tide/#Physical-Interpretation","page":"Internal Tide","title":"Physical Interpretation","text":"This test case demonstrates that temporal discretization alone can introduce significant numerical mixing, with AB2 showing diffusivity comparable to low-order spatial schemes. The RK3 formulation substantially reduces this mixing, preserving wave energy and stratification over the 40-day integration.","category":"section"}]
}
